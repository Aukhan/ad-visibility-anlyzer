!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){i(1),t.exports=i(2)},function(t,e,i){t.exports=i.p+"index.html"},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}i.r(e);var o=function(){function t(e,i,r){if(n(this,t),void 0===e||"undefined"===i||void 0===r)return console.warn("Tried to create an invalid event");this.adId=e.id,this.isVisible=i,this.percentage=r,this.timestamp=(new Date).getTime()}var e,i,o;return e=t,(i=[{key:"visible",value:function(){return this.isVisible||!!this.percentage}}])&&r(e.prototype,i),o&&r(e,o),t}(),a=function t(e,i){if(n(this,t),void 0===e||void 0===i)return console.warn("Tried to create an invalid event");this.adId=e.id,this.x=i.clientX,this.y=i.clientY,this.timestamp=(new Date).getTime()};function s(t){return function(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function l(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var c={isVisible:!1,percentage:0,viewabilityTime:0,lastChangeTimeStamp:0,click:0},h=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.changeLog=[],this.clickLog=[],this.stats=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){u(t,e,i[e])})}return t}({},c),this.startUpdateTimer()}var e,i,n;return e=t,(i=[{key:"getLastEvent",value:function(t){return t[t.length-1]}},{key:"pushEvent",value:function(t){t instanceof o?this.preserveVisibilityEvent(t):t instanceof a&&this.preserveClickEvent(t)}},{key:"preserveVisibilityEvent",value:function(t){var e=this.getLastEvent(this.changeLog);e&&t.isVisible===e.isVisible&&t.percentage===e.percentage||this.changeLog.push(t)}},{key:"preserveClickEvent",value:function(t){this.clickLog.push(t)}},{key:"getStats",value:function(){return this.stats}},{key:"updateVisibilityStats",value:function(){if(this.lastIndex=this.lastIndex||0,this.lastIndex!==this.changeLog.length){for(var t=s(this.changeLog).splice(this.lastIndex),e=0;e<t.length;e++){var i=t[e-1],n=t[e];if(this.stats.isVisible=n.visible(),this.stats.percentage=n.percentage,this.stats.lastChangeTimeStamp=n.timestamp,i&&i.visible()){var r=(i.timestamp-n.timestamp)/1e3;this.stats.viewabilityTime+=r}}this.lastIndex=this.changeLog.length}else{var o=this.changeLog[this.lastIndex-1];if(o&&o.visible()){var a=((new Date).getTime()-o.timestamp)/1e3;this.stats.viewabilityTime+=a}}}},{key:"updateClickStats",value:function(){this.stats.clicks=this.clickLog.reduce(function(t,e){return t+1},0)}},{key:"startUpdateTimer",value:function(){var t=this;this.updateTimer=setInterval(function(){t.updateVisibilityStats(),t.updateClickStats()},100)}},{key:"stopUpdateTimer",value:function(){clearInterval(this.updateTimer)}}])&&l(e.prototype,i),n&&l(e,n),t}();function f(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var d,v,p=function(){function t(e,i){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e,this.window=i,this.el=i.document.querySelector(e),this.state=new h,!this.el)return console.warn("Unable to attach a document element");this.el.onclick=this.onClick.bind(this)}var e,i,n;return e=t,(i=[{key:"getComputedStyle",value:function(){return this.window.getComputedStyle(this.el)}},{key:"isVisibleByStyle",value:function(){var t=this.getComputedStyle();return"0"!==t.width&&"0"!==t.height&&"0"!==t.opacity&&"none"!==t.display&&"hidden"!==t.visibility}},{key:"getVisibilityPercentage",value:function(){var t=this.el.getBoundingClientRect(),e={left:0,top:0,bottom:this.window.innerHeight,right:this.window.innerWidth,width:this.window.innerWidth,height:this.window.innerHeight};if(!this.isVisibleByStyle())return 0;if(t.right<=0)return 0;if(t.bottom<=0)return 0;if(t.left>e.right)return 0;if(t.top>=e.bottom)return 0;var i=t.left>0?t.left:0,n=t.top>0?t.top:0,r=(t.right<e.right?t.right:e.right)-i,o=(t.bottom<e.bottom?t.bottom:e.bottom)-n,a=this.getRectArea(t.height,t.width);return this.getRectArea(o,r)/a*100}},{key:"getRectArea",value:function(t,e){return t*e}},{key:"pushVisibilityChange",value:function(t,e){if(void 0!==t&&void 0!==e)this.state.pushEvent(new o(this,t,e));else{var i=this.getVisibilityPercentage();this.state.pushEvent(new o(this,!!i,i))}}},{key:"onClick",value:function(t){this.state.pushEvent(new a(this,t))}}])&&f(e.prototype,i),n&&f(e,n),t}();function b(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}void 0!==document.hidden?(d="hidden",v="visibilitychange"):void 0!==document.msHidden?(d="msHidden",v="msvisibilitychange"):void 0!==document.webkitHidden&&(d="webkitHidden",v="webkitvisibilitychange");var g=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,i,n;return e=t,n=[{key:"init",value:function(t,e){var i=this;return t.length?e?(this.window=e,this.ads=[],t.forEach(function(t){return i.ads.push(new p(t,e))}),this.setupEvents(),void this.startUpdateTimer()):console.error("App requires window object to initialize"):console.error("App expects an array of selectors")}},{key:"setupEvents",value:function(){void 0===document.addEventListener||void 0===d?console.warn("This demo requires a browser, such as Google Chrome or Firefox, that supports the Page Visibility API."):document.addEventListener(v,this.onPageVisibilityChanged.bind(this),!1),window.onbeforeunload=this.onWindowClosed.bind(this)}},{key:"onPageVisibilityChanged",value:function(){document[d]?(this.stopUpdateTimer(),this.pushVisibilityChange(!1,0)):this.startUpdateTimer()}},{key:"onWindowClosed",value:function(){this.pushVisibilityChange(!1,0)}},{key:"pushVisibilityChange",value:function(t,e){this.ads.forEach(function(i){return i.pushVisibilityChange(t,e)})}},{key:"startUpdateTimer",value:function(){this.updateTimer=setInterval(this.pushVisibilityChange.bind(this),100)}},{key:"stopUpdateTimer",value:function(){clearInterval(this.updateTimer)}},{key:"log",value:function(){var t=this;this.ads.forEach(function(e){var i=e.state.getStats(),n=i.isVisible,r=i.percentage,o=i.viewabilityTime,a=i.clicks,s="AD        : ".concat(e.id," \nVISIBLE   : ").concat(n," \nPERCENTAGE: ").concat(t.round(r),"% \nTIME      : ").concat(t.round(o),"s \nCLICKS    : ").concat(a);r<50?console.warn(s):console.info(s)})}},{key:"round",value:function(t){return Math.round(100*t+Number.EPSILON)/100}}],(i=null)&&b(e.prototype,i),n&&b(e,n),t}();g.init(["#ad"],window),setInterval(function(){g.log()},500)}]);